<div *ngIf = "selectedOrder$ | async as ord " >
<div>
  <mat-toolbar color="primary">
    <div class="button-row" style="flex:1">
      <h1 mat-dialog-title>
        {{order.type == 'purchase' ? 'Purchase ': 'Sales '}} Order
        - {{order.referenceno}}

      </h1>

    </div>




    <div class="abc">

      <button mat-icon-button class="" (click)="printPreview()">
        <fa-icon icon="print" transform="grow-15"></fa-icon>
      </button>
    </div>

  </mat-toolbar>
</div>


<!-- Mat Toolbar End ------------------------------>



<mat-dialog-content class="mt-4 mb-1" style="margin-top: 0px !important;">

  <mat-tab-group>


    <mat-tab label="Products">

      <div class="detail-table mt-4 mb-4">
        <table>

          <tr>
            <td class="label">Supplier</td>
            <td class="data">{{order.supplierName}}</td>
            <td class="spacer"> </td>
            <td class="label">Order Date</td>
            <td class="data">{{order.orderdate * 1000 | date: 'd MMM yy'}}</td>
          </tr>

          <tr>
            <td class="label">Customer</td>
            <td class="data">{{order.customerName}}</td>
            <td class="spacer"> </td>
            <td class="label">Status</td>
            <td class="data">{{order.status}}</td>
          </tr>

          <tr>
            <td class="label">Total Amt</td>
            <td class="data amount">{{order.rupTotalAmount}}</td>
            <td class="spacer"> </td>
            <td class="label">Balance</td>
            <td class="data amount">{{order.rupBalance}}</td>
          </tr>


        </table>
      </div>


      <!-- PO Action toolbar -->
      <div>
        <mat-toolbar color="primary">
          <div class="button-row" style="flex:1">
          </div>
            <button mat-icon-button class="">

            </button>

            <!-- Payment-->
            <button mat-raised-button color="accent">
             &#8377; &nbsp; Enter Payment
            </button>

            <!-- Status-->

            <button mat-raised-button color="accent" class="ml-4">
              Update Status &nbsp;<fa-icon color="primary" icon="rocket"></fa-icon>
            </button>

           </mat-toolbar>
      </div>




      <div class=" border">
        <table mat-table [dataSource]="order.poproductlist" class="mat-elevation-z0">

          <ng-container matColumnDef="Slno">
            <th mat-header-cell *matHeaderCellDef> Sl. No. </th>
            <td mat-cell *matCellDef="let index = index"> {{index + 1}} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>


          <ng-container matColumnDef="Description">
            <th mat-header-cell *matHeaderCellDef> Product </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.productName }} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>

          <ng-container matColumnDef="Quantity">
            <th mat-header-cell *matHeaderCellDef> Quantity </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.quantity}} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>


          <ng-container matColumnDef="Rate">
            <th mat-header-cell *matHeaderCellDef> Rate </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.rupPrice }} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>



          <ng-container matColumnDef="Amount">
            <th mat-header-cell *matHeaderCellDef> Amount </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.price * transaction.quantity  | number : '1.0-0'}} </td>
            <td mat-footer-cell *matFooterCellDef> {{order.rupTotalAmount}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          <tr mat-footer-row *matFooterRowDef="displayedColumns;"></tr>
        </table>
      </div>






    </mat-tab>

    <mat-tab label="invoices">
      <mat-tab-group>
        <mat-tab label="inv-1">

          <div class="detail-table mt-4 mb-4">
            <table>
    
              <tr>
                <td class="label">Supplier</td>
                <td class="data">{{order.supplierName}}</td>
                <td class="spacer"> </td>
                <td class="label">Order Date</td>
                <td class="data">{{order.orderdate * 1000 | date: 'd MMM yy'}}</td>
              </tr>
    
              <tr>
                <td class="label">Customer</td>
                <td class="data">{{order.customerName}}</td>
                <td class="spacer"> </td>
                <td class="label">Status</td>
                <td class="data">{{order.status}}</td>
              </tr>
    
              <tr>
                <td class="label">Total Amt</td>
                <td class="data amount">{{order.rupTotalAmount}}</td>
                <td class="spacer"> </td>
                <td class="label">Balance</td>
                <td class="data amount">{{order.rupBalance}}</td>
              </tr>
    
    
            </table>
          </div>
    
    
          <!-- PO Action toolbar -->
          <div>
            <mat-toolbar color="primary">
              <div class="button-row" style="flex:1">
              </div>
                <button mat-icon-button class="">
    
                </button>
    
                <!-- Payment-->
                <button mat-raised-button color="accent">
                 &#8377; &nbsp; Enter Payment
                </button>
    
                <!-- Status-->
    
                <button mat-raised-button color="accent" class="ml-4">
                  Update Status &nbsp;<fa-icon color="primary" icon="rocket"></fa-icon>
                </button>
    
               </mat-toolbar>
          </div>
    
    
    
    
          <div class=" border">
            <table mat-table [dataSource]="order.poproductlist" class="mat-elevation-z0">
    
              <ng-container matColumnDef="Slno">
                <th mat-header-cell *matHeaderCellDef> Sl. No. </th>
                <td mat-cell *matCellDef="let index = index"> {{index + 1}} </td>
                <td mat-footer-cell *matFooterCellDef> </td>
              </ng-container>
    
    
              <ng-container matColumnDef="Description">
                <th mat-header-cell *matHeaderCellDef> Product </th>
                <td mat-cell *matCellDef="let transaction"> {{transaction.productName }} </td>
                <td mat-footer-cell *matFooterCellDef> </td>
              </ng-container>
    
              <ng-container matColumnDef="Quantity">
                <th mat-header-cell *matHeaderCellDef> Quantity </th>
                <td mat-cell *matCellDef="let transaction"> {{transaction.quantity}} </td>
                <td mat-footer-cell *matFooterCellDef> </td>
              </ng-container>
    
    
              <ng-container matColumnDef="Rate">
                <th mat-header-cell *matHeaderCellDef> Rate </th>
                <td mat-cell *matCellDef="let transaction"> {{transaction.rupPrice }} </td>
                <td mat-footer-cell *matFooterCellDef> </td>
              </ng-container>
    
    
    
              <ng-container matColumnDef="Amount">
                <th mat-header-cell *matHeaderCellDef> Amount </th>
                <td mat-cell *matCellDef="let transaction"> {{transaction.price * transaction.quantity  | number : '1.0-0'}} </td>
                <td mat-footer-cell *matFooterCellDef> {{order.rupTotalAmount}}</td>
              </ng-container>
    
              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              <tr mat-footer-row *matFooterRowDef="displayedColumns;"></tr>
            </table>
          </div>
    
    

        </mat-tab> <mat-tab label="inv-1"></mat-tab> <mat-tab label="inv-1"></mat-tab> <mat-tab label="inv-1"></mat-tab> <mat-tab label="inv-1"></mat-tab>
      </mat-tab-group>

    </mat-tab>

    <mat-tab label="Contacts">

      <div class="info-table mt-4 mb-4">
        <table>

          <tr style="background-color: #bbdefb;"><td colspan="3" style="background-color: #bbdefb;"> <!-- Customer Info-->
            <span style="font-size: 22px;"><span> Customer: </span>{{order.customerName}}</span> <br/>
             GSTIN : {{order.customer.gstin1}} <br/>
          </td></tr>

          <tr>

            <td class="col">
              <span class="label"> Invoice Address </span> <br/>
              <span class="data"> {{ order.customerName}}</span> <br/>
              <span class="data"> {{ order.customer.invoiceContact.address1}}</span> <br/>
              <span class="data" *ngIf="order.customer.invoiceContact.address2"><span> {{ order.customer.invoiceContact.address2}}</span> <br/></span>
              <span class="data"> {{ order.customer.invoiceContact.city}}</span> ,
              <span class="data"> {{ order.customer.invoiceContact.state}}</span>,
              <span class="data"> {{ order.customer.invoiceContact.pincode}}</span> <br/>
              <span class="data"> {{ order.customer.invoiceContact.email}}</span>
            </td>

            <td class="spacer"> </td>

            <td class="col">
              <span class="label"> Dispatch Address </span> <br/>

              <span class="data"> {{ order.customerName}}</span> <br/>
              <span class="data"> {{ order.customer.dispatchContact.address1}}</span> <br/>
            <span *ngIf="order.customer.dispatchContact.address2">  <span class="data"> {{ order.customer.dispatchContact.address2}}</span> <br/></span>
              <span class="data"> {{ order.customer.dispatchContact.city}}</span> ,
              <span class="data"> {{ order.customer.dispatchContact.state}}</span>,
              <span class="data"> {{ order.customer.dispatchContact.pincode}}</span> <br/>
              <span class="data"> {{ order.customer.dispatchContact.email}}</span>


            </td>
          </tr>

          <tr><td colspan="3"> <br/> </td></tr>

          <tr style="background-color: #bbdefb;"><td colspan="3" style="background-color: #bbdefb;">  <!-- Supplier Info-->
            <span style="font-size: 22px;"><span> Supplier: </span>{{order.supplierName}}</span> <br/>
             GSTIN : {{order.supplier.gstin1}} <br/>
          </td></tr>

          <tr>

            <td class="col">
              <span class="label"> Invoice Address </span> <br/>
              <span class="data"> {{ order.supplierName}}</span> <br/>
              <span class="data"> {{ order.supplier.invoiceContact.address1}}</span> <br/>
              <span class="data" *ngIf="order.supplier.invoiceContact.address2"><span> {{ order.supplier.invoiceContact.address2}}</span> <br/></span>
              <span class="data"> {{ order.supplier.invoiceContact.city}}</span> ,
              <span class="data"> {{ order.supplier.invoiceContact.state}}</span>,
              <span class="data"> {{ order.supplier.invoiceContact.pincode}}</span> <br/>
              <span class="data"> {{ order.supplier.invoiceContact.email}}</span>
            </td>

            <td class="spacer"> </td>

            <td class="col">

            </td>
          </tr>





        </table>
      </div>


    </mat-tab>

    <mat-tab label="Related Sales" *ngIf="order.type == 'purchase'">

      <div class="col-12">

        <table id="sales" mat-table [dataSource]="soDataSource" class="mat-elevation-z0">

            <ng-container matColumnDef="orderdate">
                <th id="orderdate-h" mat-header-cell *matHeaderCellDef>Order Date</th>
                <td id="orderdate" mat-cell *matCellDef="let element">
                    {{ element.orderdate * 1000 | date:  'd MMM yy'}}
                </td>
            </ng-container>


            <ng-container matColumnDef="referenceno">
                <th id="s-referenceno-h" mat-header-cell *matHeaderCellDef>Reference</th>
                <td id="s-referenceno" mat-cell *matCellDef="let element">

                    <button mat-button color="primary" (click)="viewOrder(element)">
                        {{element.referenceno }}
                    </button>
                </td>
            </ng-container>

            <ng-container matColumnDef="customerName">
                <th id="s-customerName-h" mat-header-cell *matHeaderCellDef>Customer</th>
                <td id="s-customerName" mat-cell *matCellDef="let element">{{element.customerName }}</td>
            </ng-container>



            <ng-container matColumnDef="totalAmount">
                <th id="s-totalAmount-h" mat-header-cell *matHeaderCellDef>Total Amt</th>
                <td id="s-totalAmount" mat-cell *matCellDef="let element">{{element.rupTotalAmount }}</td>
            </ng-container>

            <ng-container matColumnDef="status">
                <th id="s-status-h" mat-header-cell *matHeaderCellDef>Status</th>
                <td id="s-status" mat-cell *matCellDef="let element">
                    {{element.status }}
                    <span *ngIf="element.status == 'confirm'">
                        {{ element.confirmdate * 1000 | date:  date:  'd MMM yy'}}</span>
                    <span *ngIf="element.shipdate == 'shipped'">
                        {{ element.receivedate * 1000 | date:  date:  'd MMM yy'}}</span>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="soDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: soDisplayedColumns;" class="detail-row"></tr>


        </table>

    </div>

    </mat-tab>

    <mat-tab label="Linked Purchase Order" *ngIf="order.purchase != null">

      <div style="width: 100%; background-color: #c5e1a5;
      padding: 10px; border-radius: 5px; border: 1px solid b0bec5;">


      <button mat-button color="primary">
       <h3>Purchase Order: {{order.purchase.referenceno}}</h3>
      </button>


      </div>


      <div class="detail-table mt-4 mb-4">


        <table>


          <tr>
            <td class="label">Supplier</td>
            <td class="data">{{order.purchase.supplierName}}</td>
            <td class="spacer"> </td>
            <td class="label">Order Date</td>
            <td class="data">{{order.purchase.orderdate * 1000 | date: 'd MMM yy'}}</td>
          </tr>

          <tr>
            <td class="label">Customer</td>
            <td class="data">{{order.purchase.customerName}}</td>
            <td class="spacer"> </td>
            <td class="label">Status</td>
            <td class="data">{{order.purchase.status}}</td>
          </tr>

          <tr>
            <td class="label">Total Amt</td>
            <td class="data amount">{{order.purchase.rupTotalAmount}}</td>
            <td class="spacer"> </td>
            <td class="label">Balance</td>
            <td class="data amount">{{order.purchase.rupBalance}}</td>
          </tr>


        </table>
      </div>






      <div class="border">
        <table mat-table [dataSource]="order.purchase.poproductlist" class="col-12">

          <ng-container matColumnDef="Slno">
            <th mat-header-cell *matHeaderCellDef> Sl. No. </th>
            <td mat-cell *matCellDef="let index = index"> {{index + 1}} </td>
            <td mat-footer-cell *matFooterCellDef></td>
          </ng-container>


          <ng-container matColumnDef="Description">
            <th mat-header-cell *matHeaderCellDef> Product </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.product.name }} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>

          <ng-container matColumnDef="Quantity">
            <th mat-header-cell *matHeaderCellDef> Quantity </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.quantity}} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>


          <ng-container matColumnDef="Rate">
            <th mat-header-cell *matHeaderCellDef> Rate </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.rupPrice }} </td>
            <td mat-footer-cell *matFooterCellDef> </td>
          </ng-container>




          <ng-container matColumnDef="Amount">
            <th mat-header-cell *matHeaderCellDef> Amount </th>
            <td mat-cell *matCellDef="let transaction"> {{transaction.price * transaction.quantity | number : '1.0-0'}} </td>
            <td mat-footer-cell *matFooterCellDef> {{order.rupTotalAmount}} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          <tr mat-footer-row *matFooterRowDef="displayedColumns;"></tr>
        </table>
      </div>

      <table>


      </table>





    </mat-tab>

  </mat-tab-group>









</mat-dialog-content>


<mat-dialog-actions align="end" class="mt-1">

  <button id="cancel-btn" mat-raised-button color="accent" (click)="editOrder()">Edit</button>
  <button id="cancel-btn" mat-raised-button  color="warn" (click)="onClose()">Close</button>

</mat-dialog-actions>
</div>
